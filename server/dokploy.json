{
  "name": "wecamp-backend",
  "type": "docker",
  "description": "WeCamp Marketplace Backend API",
  "docker": {
    "dockerfile": "Dockerfile",
    "buildContext": "server",
    "buildArgs": {},
    "ports": [
      {
        "container": 80,
        "public": 80,
        "protocol": "tcp"
      }
    ],
    "volumes": [
      {
        "name": "wecamp-uploads",
        "mountPath": "/app/uploads",
        "description": "User uploaded files (images, documents)"
      },
      {
        "name": "wecamp-logs",
        "mountPath": "/app/logs",
        "description": "Application logs"
      }
    ],
    "healthcheck": {
      "enabled": true,
      "path": "/health",
      "interval": 30,
      "timeout": 3,
      "retries": 3,
      "startPeriod": 40
    },
    "restart": "unless-stopped",
    "replicas": 1
  },
  "environment": {
    "NODE_ENV": "production",
    "PORT": "3000",
    "LOG_LEVEL": "info",
    "MAX_FILE_SIZE": "10485760",
    "ALLOWED_FILE_TYPES": "image/jpeg,image/png,image/webp,image/jpg",
    "UPLOAD_DIR": "/app/uploads",
    "MAX_USER_UPLOAD_QUOTA": "1073741824",
    "RATE_LIMIT_WINDOW_MS": "900000",
    "RATE_LIMIT_MAX_REQUESTS": "100",
    "MAX_UPLOADS_PER_HOUR": "50",
    "ENABLE_CSRF": "false",
    "ENABLE_VIRUS_SCAN": "false",
    "REQUIRE_VIRUS_SCAN": "false",
    "HTTPS_ENFORCE": "true",
    "MAX_JSON_SIZE": "1mb",
    "MAX_URLENCODED_SIZE": "1mb",
    "CORS_CREDENTIALS": "true",
    "CORS_MAX_AGE": "86400",
    "JWT_EXPIRES_IN": "7d",
    "JWT_REFRESH_EXPIRES_IN": "30d"
  },
  "secrets": [
    {
      "key": "DB_HOST",
      "required": true,
      "description": "MySQL database host (use service name if Dokploy MySQL)"
    },
    {
      "key": "DB_USER",
      "required": true,
      "description": "MySQL database user"
    },
    {
      "key": "DB_PASSWORD",
      "required": true,
      "description": "MySQL database password"
    },
    {
      "key": "DB_NAME",
      "required": true,
      "description": "MySQL database name"
    },
    {
      "key": "DB_PORT",
      "required": true,
      "description": "MySQL database port (default: 3306)"
    },
    {
      "key": "JWT_SECRET",
      "required": true,
      "description": "JWT secret for access token (min 64 characters)"
    },
    {
      "key": "JWT_REFRESH_SECRET",
      "required": true,
      "description": "JWT secret for refresh token (min 64 characters)"
    },
    {
      "key": "FRONTEND_URL",
      "required": true,
      "description": "Frontend application URL (https://wecamp.com.tr)"
    },
    {
      "key": "ALLOWED_ORIGINS",
      "required": true,
      "description": "Comma-separated list of allowed CORS origins"
    }
  ],
  "services": [
    {
      "name": "wecamp-mysql",
      "type": "mysql",
      "version": "8.0",
      "environment": {
        "MYSQL_DATABASE": "wecamp_marketplace",
        "MYSQL_ROOT_PASSWORD": "${DB_PASSWORD}"
      },
      "volumes": [
        {
          "name": "mysql-data",
          "mountPath": "/var/lib/mysql"
        }
      ],
      "healthcheck": {
        "command": ["CMD", "mysqladmin", "ping", "-h", "localhost"],
        "interval": 10,
        "timeout": 5,
        "retries": 5
      },
      "ports": [
        {
          "container": 3306,
          "internal": true
        }
      ]
    }
  ],
  "deployment": {
    "strategy": "rolling",
    "maxSurge": 1,
    "maxUnavailable": 0
  },
  "resources": {
    "limits": {
      "cpu": "1000m",
      "memory": "512Mi"
    },
    "requests": {
      "cpu": "500m",
      "memory": "256Mi"
    }
  },
  "scaling": {
    "enabled": false,
    "minReplicas": 1,
    "maxReplicas": 3,
    "targetCPU": 70,
    "targetMemory": 80
  },
  "domains": [
    {
      "domain": "api.wecamp.com.tr",
      "ssl": {
        "enabled": true,
        "provider": "letsencrypt",
        "email": "admin@wecamp.com.tr"
      }
    }
  ],
  "monitoring": {
    "enabled": true,
    "metrics": true,
    "logs": true
  }
}



